---
description: WÃ¤hrend Georg schreibt und AI programmiert â€“ AbstÃ¼rze (Code 5, Cursor-Preview) NIEMALS wieder verursachen. Jede Session muss das einhalten.
alwaysApply: true
---

# ðŸ”’ CRASH WÃ„HREND PROGRAMMIEREN â€“ NIEMALS WIEDER (kritisch fÃ¼r Georg)

## Was immer wieder passiert

- **Georg schreibt, du (AI) programmierst** â†’ Cursor/Preview stÃ¼rzt ab (Code 5, â€žwindow terminatedâ€œ, HMR-Chaos).
- Das wurde **schon sehr oft** besprochen. Georg erlebt: Es wird **nichts dauerhaft gemerkt**. Diese Regel stellt sicher, dass **jede** Session (AI/Entwickler) die gleichen SchutzmaÃŸnahmen einhÃ¤lt.

## UnverÃ¤nderliche Regeln (bei JEDER Code-Ã„nderung prÃ¼fen)

### 1. Kein automatischer Reload

- **NIEMALS** automatischen Reload einbauen (â€žwenn Server neuer â†’ reloadâ€œ). Nur Badge/Button, Nutzer tippt. Details: `code-5-crash-kein-auto-reload.mdc`.

### 2. Kein location.replace / redirect in Cursor-Preview

- **In main.tsx:** Redirect (z. B. Cache-Buster fÃ¼r Mobile) **nur**, wenn **nicht** in iframe: `window.self === window.top`. In Cursor Preview lÃ¤uft die App oft in einem iframe; dort **niemals** `location.replace` oder `location.href` setzen â€“ sonst Reload/Chaos/Crash.

### 3. HMR-sicher programmieren

- **useEffect:** Immer Cleanup (return-Funktion): Listener entfernen, clearTimeout/clearInterval, Abos kÃ¼ndigen. **Kein** setState nach Unmount (z. B. isMounted-Flag oder Abbruch in Cleanup).
- **Event-Listener (window, document):** Immer im gleichen useEffect registrieren und im Cleanup entfernen. Nie dauerhaft ohne Cleanup.
- **setInterval/setTimeout:** Immer im Cleanup clearen. Bei HMR bleiben sonst alte Timer aktiv â†’ Mehrfach-Feuer â†’ Crash.
- **Schwere Berechnungen / groÃŸe Daten im Render:** Vermeiden; useMemo/useCallback nutzen, damit HMR nicht bei jedem Speichern alles neu rechnet und den Prozess Ã¼berlastet.

### 4. Cursor-Preview schonen

- Keine unnÃ¶tigen globalen Listener oder Intervalle in main.tsx/App.tsx, die bei jedem HMR dazukommen. Console-Log-Limits (wie vorhanden) beibehalten. Cursor Preview = instabil bei Speicher-/CPU-Spitzen.

### 5. Nach Absturz sofort orientieren

- Wenn Georg â€žAbsturzâ€œ meldet: `docs/WEITERARBEITEN-NACH-ABSTURZ.md` lesen und Schritte abarbeiten. Regel: `nach-absturz-orientierung.mdc`.

## Checkliste VOR dem Abschluss von Code-Ã„nderungen

- [ ] Kein neuer automatischer Reload eingebaut?
- [ ] main.tsx: Redirect nur wenn `window.self === window.top` (nicht in iframe)?
- [ ] Neue useEffects haben Cleanup (Listener/Timer entfernt)?
- [ ] Keine neuen globalen Listener ohne Cleanup?

## Kurzfassung

**Crash wÃ¤hrend Programmieren = Georgs grÃ¶ÃŸter Frust. Diese Regel + code-5-crash-kein-auto-reload + saubere Cleanups + kein Redirect in iframe einhalten. Jede Session, jedes Mal.**
