---
description: ABSOLUTES VERBOT â€“ Kundendaten niemals automatisch lÃ¶schen oder Ã¼berschreiben
alwaysApply: true
---

# ğŸ”´ ABSOLUTES VERBOT â€“ KUNDENDATEN NIEMALS AUTOMATISCH LÃ–SCHEN

## Diese Regel hat keine Ausnahmen. Keine. Nie.

Im Echtbetrieb bedeutet ein stiller Datenverlust:
- Kunstwerke eines KÃ¼nstlers fÃ¼r immer weg
- Mitgliederliste eines Vereins vernichtet
- Stammdaten (Name, Kontakt, Adresse) gelÃ¶scht
- Kein Backup weil der Code das Backup auch Ã¼berschrieben hat

**Das ist der Supergau. Er darf nie passieren.**

---

## ğŸ”´ ABSOLUT VERBOTEN â€“ immer, Ã¼berall, ohne Ausnahme

```typescript
// âŒ VERBOTEN â€“ lÃ¶scht still Kundendaten beim Laden
const filtered = list.filter(...)
localStorage.setItem('k2-artworks', JSON.stringify(filtered))

// âŒ VERBOTEN â€“ lÃ¶scht alle k2-* Keys (auch Werke, Stammdaten)
for (let i = 0; i < localStorage.length; i++) {
  if (k.startsWith('k2-')) localStorage.removeItem(k)
}

// âŒ VERBOTEN â€“ Ã¼berschreibt lokale Werke mit Server-Daten ohne PrÃ¼fung
setArtworks(serverData)
localStorage.setItem('k2-artworks', JSON.stringify(serverData))

// âŒ VERBOTEN â€“ automatisches "AufrÃ¤umen" beim Start/Laden
if (filtered.length < list.length) {
  localStorage.setItem(key, JSON.stringify(filtered)) // NEIN!
}

// âŒ VERBOTEN â€“ localStorage.clear() oder sessionStorage.clear() fÃ¼r Kundendaten
localStorage.clear() // lÃ¶scht ALLES â€“ niemals!
```

---

## âœ… EINZIG ERLAUBTE AKTIONEN MIT KUNDENDATEN

```typescript
// âœ… Nur lesen
const raw = localStorage.getItem('k2-artworks')
const list = JSON.parse(raw || '[]')

// âœ… Nur warnen wenn etwas verdÃ¤chtig ist â€“ nie lÃ¶schen
if (verdaechtig.length > 0) {
  console.warn('âš ï¸ VerdÃ¤chtige EintrÃ¤ge gefunden:', verdaechtig)
  // STOP. Kein setItem. Kein removeItem. Nur warnen.
}

// âœ… Schreiben NUR nach expliziter User-Aktion (Klick auf Button)
// Beispiel: User klickt "Werk lÃ¶schen" â†’ dann und nur dann:
const neu = artworks.filter((_, i) => i !== zuLoeschenderIndex)
localStorage.setItem('k2-artworks', JSON.stringify(neu))

// âœ… Backup erstellen â€“ lesen + extra Key schreiben, nie Ã¼berschreiben
localStorage.setItem('k2-artworks-backup', JSON.stringify(aktuelleWerke))

// âœ… Crash-Handler: nur sichere UI/Session-Keys lÃ¶schen
const SAFE_TO_DELETE = [
  'k2-admin-unlocked', 'k2-admin-unlocked-expiry',
  'k2-last-loaded-timestamp', 'k2-guide-flow', ...
]
SAFE_TO_DELETE.forEach(k => localStorage.removeItem(k))
// NIEMALS k2-artworks, k2-stammdaten-*, k2-vk2-stammdaten, k2-oeffentlich-*
```

---

## ğŸ”´ DIE GESCHÃœTZTEN KEYS â€“ niemals automatisch lÃ¶schen/Ã¼berschreiben

| Key | Inhalt | Schutz |
|---|---|---|
| `k2-artworks` | Echte Werke Martina & Georg | ğŸ”´ ABSOLUT GESCHÃœTZT |
| `k2-stammdaten-martina` | Echte Kontaktdaten Martina | ğŸ”´ ABSOLUT GESCHÃœTZT |
| `k2-stammdaten-georg` | Echte Kontaktdaten Georg | ğŸ”´ ABSOLUT GESCHÃœTZT |
| `k2-stammdaten-galerie` | Echte Galeriedaten | ğŸ”´ ABSOLUT GESCHÃœTZT |
| `k2-vk2-stammdaten` | Vereins-Mitgliederliste | ğŸ”´ ABSOLUT GESCHÃœTZT |
| `k2-oeffentlich-artworks` | Demo-Werke | ğŸ”´ ABSOLUT GESCHÃœTZT |
| `k2-artworks-backup` | Backup echte Werke | ğŸ”´ ABSOLUT GESCHÃœTZT |
| `k2-events` | Echte Events | ğŸ”´ ABSOLUT GESCHÃœTZT |
| `k2-documents` | Echte Dokumente | ğŸ”´ ABSOLUT GESCHÃœTZT |

---

## ğŸ”´ SERVER-SYNC SCHUTZ â€“ PflichtprÃ¼fung vor jedem Ãœberschreiben

Bevor Server-Daten lokale Daten ersetzen, MUSS gelten:

```typescript
// 1. Server darf nie mit leerer Liste Ã¼berschreiben
if (serverData.length === 0) {
  console.warn('âš ï¸ Server lieferte leer â€“ lokale Daten bleiben')
  return
}

// 2. Server darf nicht mit drastisch kleinerer Liste Ã¼berschreiben
const lokalAnzahl = loadArtworks()?.length ?? 0
if (serverData.length < lokalAnzahl * 0.5) {
  console.warn(`âš ï¸ Server: ${serverData.length}, lokal: ${lokalAnzahl} â€“ zu groÃŸer Unterschied, Sync Ã¼bersprungen`)
  return
}

// Erst dann Ã¼berschreiben
localStorage.setItem('k2-artworks', JSON.stringify(serverData))
```

---

## Checkliste vor JEDER Code-Ã„nderung die localStorage berÃ¼hrt

- [ ] Schreibe ich in einen geschÃ¼tzten Key? â†’ Nur nach User-Aktion erlaubt
- [ ] Filtere ich Daten und schreibe zurÃ¼ck? â†’ VERBOTEN
- [ ] LÃ¶sche ich Keys automatisch? â†’ Nur SAFE_TO_DELETE-Liste erlaubt
- [ ] Kommt die Ã„nderung vom Server? â†’ Leer-PrÃ¼fung + 50%-PrÃ¼fung pflicht
- [ ] Crash-Handler? â†’ Nur SAFE_TO_DELETE, nie Werk/Stammdaten-Keys

## Kurzfassung

**Kundendaten lÃ¶scht NUR der Kunde â€“ durch einen bewussten Klick.**
**Code lÃ¶scht nie automatisch. Nie. Auch nicht zur Sicherheit. Auch nicht zum AufrÃ¤umen.**
**Filter + localStorage.setItem = verboten. Immer.**
